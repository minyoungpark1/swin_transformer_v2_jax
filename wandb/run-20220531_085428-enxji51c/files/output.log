Namespace(accumulation_steps=None, amp_opt_level=None, batch_size=None, cache_mode='part', cfg='./config/swint_torch.yaml', data_path=None, disable_amp=False, eval=False, name='swint_jax', opts=None, pretrained=None, resume=None, seed=304, tag=None, throughput=False, use_checkpoint=False, zip=False)
AMP_ENABLE: True
AMP_OPT_LEVEL:
AUG:
  AUTO_AUGMENT: rand-m9-mstd0.5-inc1
  COLOR_JITTER: 0.4
  CUTMIX: 1.0
  CUTMIX_MINMAX: None
  MIXUP: 0.8
  MIXUP_MODE: batch
  MIXUP_PROB: 1.0
  MIXUP_SWITCH_PROB: 0.5
  RECOUNT: 1
  REMODE: pixel
  REPROB: 0.25
BASE: ['']
DATA:
  BATCH_SIZE: 64
  CACHE_MODE: part
  DATASET: imagenet
  DATA_PATH: /content/drive/MyDrive/jax_exercise/swin_transformer_jax/imagenette2
  IMG_SIZE: 256
  INTERPOLATION: bicubic
  NUM_WORKERS: 8
  PIN_MEMORY: True
  ZIP_MODE: False
EVAL_MODE: False
LOCAL_RANK: 0
LOG_DIR: /content/drive/MyDrive/jax_exercise/log
MODEL:
  DROP_PATH_RATE: 0.2
  DROP_RATE: 0.0
  LABEL_SMOOTHING: 0.1
  NAME: swinv2_tiny
  NUM_CLASSES: 10
  PRETRAINED:
  RESUME:
  SWIN:
    APE: False
    DEPTHS: [2, 2, 6, 2]
    EMBED_DIM: 96
    IN_CHANS: 3
    MLP_RATIO: 4.0
    NUM_HEADS: [3, 6, 12, 24]
    PATCH_NORM: True
    PATCH_SIZE: 4
    QKV_BIAS: True
    QK_SCALE: None
    WINDOW_SIZE: 7
  SWINV2:
    APE: False
    DEPTHS: [2, 2, 6, 2]
    EMBED_DIM: 96
    IN_CHANS: 3
    MLP_RATIO: 4.0
    NUM_HEADS: [3, 6, 12, 24]
    PATCH_NORM: True
    PATCH_SIZE: 4
    PRETRAINED_WINDOW_SIZES: [0, 0, 0, 0]
    QKV_BIAS: True
    WINDOW_SIZE: 8
  SWIN_MLP:
    APE: False
    DEPTHS: [2, 2, 6, 2]
    EMBED_DIM: 96
    IN_CHANS: 3
    MLP_RATIO: 4.0
    NUM_HEADS: [3, 6, 12, 24]
    PATCH_NORM: True
    PATCH_SIZE: 4
    WINDOW_SIZE: 7
  TYPE: swinv2
OUTPUT: /content/drive/MyDrive/jax_exercise/output
PRINT_FREQ: 10
SAVE_FREQ: 1
SEED: 304
TAG: default
TEST:
  CROP: True
  SEQUENTIAL: False
THROUGHPUT_MODE: False
TRAIN:
  ACCUMULATION_STEPS: 1
  AUTO_RESUME: True
  BASE_LR: 0.0005
  CLIP_GRAD: 5.0
  EPOCHS: 300
  LR_SCHEDULER:
    DECAY_EPOCHS: 30
    DECAY_RATE: 0.1
    NAME: cosine
  MIN_LR: 5e-06
  OPTIMIZER:
    BETAS: (0.9, 0.999)
    EPS: 1e-08
    MOMENTUM: 0.9
    NAME: adamw
  START_EPOCH: 0
  USE_CHECKPOINT: False
  WARMUP_EPOCHS: 20
  WARMUP_LR: 5e-07
  WEIGHT_DECAY: 0.05
2022-05-31 08:54:32.796759: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker:
Unable to initialize backend 'tpu': INVALID_ARGUMENT: TpuPlatform is not available.
=> creating /content/drive/MyDrive/jax_exercise/output/imagenet/swint_torch
=> creating /content/drive/MyDrive/jax_exercise/log/imagenet/swinv2_tiny/swint_torch_2022-05-31-08-54
Creating dataloaders...
Found 9469 files belonging to 10 classes.
Found 3925 files belonging to 10 classes.
Loading Swin Transformer v2 model...
Epoch: [0/300] Iter:[0/148], Time: 35.0019, lr: 5.00003807246685e-07, Loss: 2.271763
Epoch: [0/300] Iter:[10/148], Time: 3.4749, lr: 2.1875021047890186e-06, Loss: 2.214574
Epoch: [0/300] Iter:[20/148], Time: 1.9736, lr: 3.875000402331352e-06, Loss: 2.175903
Epoch: [0/300] Iter:[30/148], Time: 1.4409, lr: 5.562498699873686e-06, Loss: 2.145393
Epoch: [0/300] Iter:[40/148], Time: 1.5186, lr: 7.2499969974160194e-06, Loss: 2.131948
Epoch: [0/300] Iter:[50/148], Time: 1.9953, lr: 8.937495294958353e-06, Loss: 1.882473
Epoch: [0/300] Iter:[60/148], Time: 2.3073, lr: 1.0624993592500687e-05, Loss: 1.864179
Epoch: [0/300] Iter:[70/148], Time: 2.5324, lr: 1.231249189004302e-05, Loss: 2.059760
Epoch: [0/300] Iter:[80/148], Time: 2.7166, lr: 1.3999990187585354e-05, Loss: 1.933329
Epoch: [0/300] Iter:[90/148], Time: 2.8381, lr: 1.5687488485127687e-05, Loss: 1.888185
Epoch: [0/300] Iter:[100/148], Time: 2.9437, lr: 1.7375015886500478e-05, Loss: 1.761175
Epoch: [0/300] Iter:[110/148], Time: 3.0326, lr: 1.906251418404281e-05, Loss: 2.060298
Epoch: [0/300] Iter:[120/148], Time: 3.1032, lr: 2.0749983377754688e-05, Loss: 1.945092
Epoch: [0/300] Iter:[130/148], Time: 3.1613, lr: 2.243751077912748e-05, Loss: 2.065003
Epoch: [0/300] Iter:[140/148], Time: 3.1889, lr: 2.4125009076669812e-05, Loss: 2.038077
=> saving checkpoint to /content/drive/MyDrive/jax_exercise/output/imagenet/swint_torch/checkpoint.pkl
Saving checkpoint at step: 1
Saved checkpoint at /content/drive/MyDrive/jax_exercise/output/imagenet/swint_torch/best1
Removing checkpoint at /content/drive/MyDrive/jax_exercise/output/imagenet/swint_torch/best.pth
Saving checkpoint at step: 1
Saved checkpoint at /content/drive/MyDrive/jax_exercise/output/imagenet/swint_torch/checkpoint1
Removing checkpoint at /content/drive/MyDrive/jax_exercise/output/imagenet/swint_torch/checkpoint.pth.tar
Loss: 1.936, Mean Accuracy:  0.3171, Best Accuracy:  0.3171
Traceback (most recent call last):
  File "main_jax.py", line 212, in <module>
    lr_scheduler.step(epoch)
AttributeError: 'function' object has no attribute 'step'